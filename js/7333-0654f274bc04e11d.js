try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="44d43ac5-18a7-4223-b02d-3473fe0140cd",e._sentryDebugIdIdentifier="sentry-dbid-44d43ac5-18a7-4223-b02d-3473fe0140cd")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[120,7333],{1061:(e,t,a)=>{a.d(t,{H2:()=>c,O0:()=>d,Zr:()=>f,dQ:()=>s});var r=a(33563),n=a(75451),l=a(21026);let i=a(40074).env.NEXT_PUBLIC_STATS_URL||"https://t.ampwall.com/stats",u=async e=>{if(!i)return void n.Cp(Error("Playback api: NEXT_PUBLIC_STATS_URL is not set"));try{let t=await fetch("".concat(i,"/api/v1/playback"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json().catch(()=>({error:"Failed to parse JSON"}));r.v.error("Playback api: Saving playback event failed",{status:t.status}),n.Cp(Error("Playback api: Saving playback event failed with status ".concat(t.status)),{extra:{responseText:t.statusText,responseStatus:t.status,responseBody:e?JSON.stringify(e):"Unknown error"}});return}return await t.json()}catch(t){r.v.error("Playback api: Unexpected error in tracking playback event",{error:t}),n.Cp("Playback api: Unexpected error in tracking playback event: ".concat(t),{extra:{playbackEvent:e}})}},o=async e=>{if(!i)return void n.Cp(Error("Playback api: NEXT_PUBLIC_STATS_URL is not set"));try{let t=await fetch("".concat(i,"/api/v1/streams?listenerId=").concat(e.listenerId,"&trackId=").concat(e.trackId),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok){let e=await t.json().catch(()=>({error:"Failed to parse JSON"}));r.v.error("Playback api: Saving playback event failed",{status:t.status}),n.Cp(Error("Playback api: Saving playback event failed with status ".concat(t.status)),{extra:{responseText:t.statusText,responseStatus:t.status,responseBody:e?JSON.stringify(e):"Unknown error"}});return}let a=await t.json();return l.z.object({success:l.z.boolean(),result:l.z.array(l.z.object({distro_id:l.z.string().uuid(),track_id:l.z.string().uuid(),event_position:l.z.number().optional(),track_duration:l.z.number().optional()}))}).parse(a)}catch(t){r.v.error("Playback api: Unexpected error in tracking playback event",{error:t}),n.Cp("Playback api: Unexpected error in tracking playback event: ".concat(t),{extra:{request:e}})}};async function s(e){let t={...e,skipped:!0};return await u(t)}async function c(e){let t={...e,partial:!0};return await u(t)}async function d(e){let t={...e,completed:!0};return await u(t)}async function f(e){return await o(e)}},12884:(e,t,a)=>{a.d(t,{Nt:()=>s,bq:()=>i,w0:()=>o,yT:()=>u});var r=a(21026);a(41127);let n=r.z.union([r.z.string(),r.z.number(),r.z.boolean(),r.z.null()]),l=r.z.lazy(()=>r.z.union([n,r.z.array(l),r.z.record(l)])),i=r.z.object({path:r.z.string(),alt:r.z.string(),width:r.z.number(),height:r.z.number(),createdAt:r.z.string().datetime(),uploadId:r.z.string().optional().nullable()}).and(l),u=i.transform(e=>null!=e?e:{}).optional().or(r.z.null()),o=e=>{let t=e.primaryImage||e.logoImage||e.shareImage,a=t?i.safeParse(t):void 0;return(null==a?void 0:a.success)?null==a?void 0:a.data:void 0},s=e=>{var t,a;let r=i.safeParse(null==(a=e.imageAssets)||null==(t=a.at(0))?void 0:t.metadata);return(null==r?void 0:r.success)?null==r?void 0:r.data:void 0}},21110:(e,t,a)=>{a.d(t,{x:()=>n,y:()=>l});var r=a(87139);let n=(0,r.createContext)(void 0),l=()=>{let e=(0,r.useContext)(n);if(!e)throw Error("useSessionUuidFromProvider must be used within a ModalProvider");return e}},30921:(e,t,a)=>{a.d(t,{JZ:()=>i,lY:()=>l});var r=a(21026);let n=r.z.object({artists:r.z.array(r.z.object({name:r.z.string(),path:r.z.string(),rank:r.z.number()})),album:r.z.object({id:r.z.string().uuid(),name:r.z.string(),path:r.z.string(),distroId:r.z.string().uuid(),canPurchase:r.z.boolean(),basePrice:r.z.number().nullable(),distro:r.z.object({streamLimit:r.z.number().nullable(),storeConfig:r.z.object({currency:r.z.object({id:r.z.number(),name:r.z.string()})})})}),id:r.z.string().uuid(),imagePath:r.z.string().optional(),canIncludeInLists:r.z.boolean(),title:r.z.string(),file:r.z.string().optional(),featuredTrack:r.z.boolean().default(!1),duration:r.z.number().optional().nullable(),lyrics:r.z.string().optional().nullable(),source:r.z.object({type:r.z.enum(["album"]),id:r.z.string().uuid()}),ownedByListener:r.z.boolean(),listenerTrackingData:r.z.object({isListenerDistroOwner:r.z.boolean(),listenerType:r.z.enum(["follower","regular","anonymous"])})}),l=r.z.array(n),i=70},33563:(e,t,a)=>{a.d(t,{v:()=>i});var r=a(36161),n=a.n(r);class l{info(e,t){switch(typeof e){case"string":t&&"object"==typeof t?this.logger.info(t,e):this.logger.info(e);break;case"object":this.logger.info(e)}}debug(e,t){switch(typeof e){case"string":"object"==typeof t?this.logger.debug(t,e):this.logger.debug(e);break;case"object":this.logger.debug(e)}}warn(e,t){switch(typeof e){case"string":"object"==typeof t?this.logger.warn(t,e):this.logger.warn(e);break;case"object":this.logger.warn(e)}}error(e,t){switch(typeof e){case"string":"object"==typeof t?this.logger.error(t,e):this.logger.error(e);break;case"object":this.logger.error(e)}}constructor(){this.logger=n()()}}let i=new l},33897:(e,t,a)=>{a.d(t,{Tp:()=>n,wh:()=>l});var r=a(21026);let n=r.z.object({distroId:r.z.string().uuid(),streamLimit:r.z.string()});r.z.record(r.z.string().uuid(),r.z.number());let l=r.z.string().uuid()},35028:(e,t,a)=>{a.d(t,{x:()=>o});var r=a(18833),n=a(92967),l=a(21026),i=a(30921);l.z.string().uuid();let u=l.z.object({collection:i.lY}).or(l.z.null()),o=(e,t,a)=>{let{data:l,isLoading:i}=(0,n.I)({queryKey:e,queryFn:async()=>{var e;if(!a||!a.id)return null;let t=await fetch(r.J.api.player.collection.collectionId({collectionId:a.id,collectionType:null==a?void 0:a.type})),n=await t.json();return(null==(e=u.safeParse(n).data)?void 0:e.collection)||null},enabled:t});return{data:l,isLoading:i}}},41127:(e,t,a)=>{a.d(t,{Cd:()=>u,KV:()=>n,MT:()=>b,Ui:()=>s,X7:()=>c,XX:()=>o,Xi:()=>f,aA:()=>d,dQ:()=>p,fE:()=>l,qH:()=>i});var r=a(40074);let n=!0,l="https://ampwall.com";r.env.USE_LOCAL_TRANSCODE;let i=e=>"".concat(l,"/a/").concat(e,"/"),u=(e,t)=>{let a="/"===t[0]?t.replace("/",""):"/".concat(t);return"".concat(i(e)).concat(a)},o=(e,t,a)=>{let r=t.split("/");"string"==typeof t&&t.startsWith("/a/")&&r.splice(0,3);let n=r.join("/"),i=new URL(l);return i.hostname="".concat(e,".").concat(i.hostname),i.pathname=n,i.search=a||"",i.toString()},s=(r.env.CLOUDFLARE_R2_PRIVATE_ASSETS_BUCKET,r.env.AWS_S3_TEMPORARY_AUDIO_UPLOAD_BUCKET,{sameSite:"lax",path:"/",domain:n?".ampwall.com":".ampwall.xyz",secure:n}),c="/public/general/landing/ampwall-home-2024.png",d="/public/general/new_logo_white.svg";({...s});let f=r.env.NEXT_PUBLIC_STORAGE_URL||"https://assets.ampwall.com",p=e=>{let t=e.startsWith("/")?e.slice(1):e;return"".concat(f,"/").concat(t)},b=r.env.NEXT_PUBLIC_STREAMING_URL||"https://assets.ampwall.com"},45573:(e,t,a)=>{a.d(t,{Q:()=>u});var r=a(87139),n=a(32177),l=a(21026),i=a(35028);function u(e){let[t,a,u]=(0,n.Mj)("current-playback-collection-id-".concat(e||"anonymous"),void 0),o=(0,r.useRef)(null),s=(0,r.useMemo)(()=>{if(o.current)return o.current;try{let e=l.z.object({collectionId:l.z.string().uuid(),collectionType:l.z.enum(["album","playlist"]),playbackHostname:l.z.string().optional(),playbackUrlPath:l.z.string().optional()}).safeParse(t).data||null;return o.current=e,e}catch(e){return}},[t]),c=(0,r.useCallback)((e,t,r)=>{a(()=>({collectionId:e.id,collectionType:e.type,playbackHostname:t,playbackUrlPath:r}))},[a]),[d,f]=(0,r.useState)(!1),{data:p}=(0,i.x)(["current-playback-collection",e],!d,{id:(null==s?void 0:s.collectionId)||"",type:(null==s?void 0:s.collectionType)||"album"});return(0,r.useEffect)(()=>{!d&&p&&f(!0)},[d,p]),{storedPlaybackCollection:p,storedPlaybackCollectionData:s,onPersistCurrentPlaybackCollectionId:c,clearSavedPlaybackCollectionId:u}}},48913:(e,t,a)=>{a.d(t,{A:()=>u});var r=a(87139),n=a(34167),l=a(45139);let i=(0,n.Fj)({variants:{size:{headline:{textStyle:"riffHeadline"},title:{textStyle:"riffTitle"},body:{textStyle:"riffBody"},label:{textStyle:"riffBody"},meta:{textStyle:"riffMeta"},body1:{textStyle:"ampBody1"},body2:{textStyle:"ampBody2"},h1:{textStyle:"ampH1"},h2:{textStyle:"ampH2"},h3:{textStyle:"ampH3"},h4:{textStyle:"ampH4"},h5:{textStyle:"ampH5"},h6:{textStyle:"ampH6"},caption:{textStyle:"ampCap"},overline:{textStyle:"ampOverline"},link:{textStyle:"inlineLink"},legend:{textStyle:"bodyBold"},button:{textStyle:"ampButton"}},weight:{bold:{textStyle:"bodyBold"}},error:{true:{color:"content.utility.error"}}},defaultVariants:{size:"body1"}}),u=(0,l.I4)(e=>{let{as:t="div",...a}=e;return r.createElement(t||"div",{...a})},i)},53880:(e,t,a)=>{a.d(t,{A:()=>i});var r=a(34167),n=a(45139);let l=(0,r.Fj)({base:{willChange:"color",transition:"color 0.2s ease-in-out"},variants:{inline:{true:{display:"inline-block",height:"1.25rem",width:"1.25rem"}},color:{currentColor:{},gray:{"& > path":{fill:"amp5"}},black:{"& > path":{fill:"amp0"}},white:{"& > path":{fill:"amp6"}},active:{"& > path":{fill:"content.brand"}},green:{"& > path":{fill:"#55FF05"}},error:{"& > path":{fill:"content.utility.error"}},orange:{"& > path":{fill:"#FF9B05"}}}},defaultVariants:{color:"white"}}),i=(0,n.I4)("svg",l)},71399:(e,t,a)=>{a.d(t,{default:()=>s});var r=a(40828),n=a(87139),l=a(21110),i=a(32177),u=a(23286),o=a(33897);let s=e=>{let{children:t}=e,{sid:a}=function(){let[e,t]=(0,i.Mj)("sid",(0,u.A)()),[a,r]=n.useState("");return n.useEffect(()=>{let a=o.wh.safeParse(e).data||(0,u.A)();t(a),r(a)},[]),{sid:a}}();return(0,r.jsx)(l.x.Provider,{value:{storedSessionUuid:a},children:t})}},78545:(e,t,a)=>{a.r(t),a.d(t,{cloudflareImageOrOriginal:()=>l,default:()=>i});var r=a(41127);let n=e=>e.startsWith("https://assets.ampwall.com/")?e.replace("https://assets.ampwall.com/",""):e.startsWith("/")?e.slice(1):e;function l(e,t){let{src:a,width:n,quality:l,format:u="avif"}=e;if(a)return t||r.KV?i({src:a,width:n,quality:l,format:u}):a}function i(e){let{src:t,width:a,quality:r,format:l="avif"}=e,i=["format=".concat(l),"width=".concat(a)];r&&i.push("quality=".concat(r));let u=i.join(",").replace(/ /g,"");return"https://assets.ampwall.com/cdn-cgi/image/".concat(u,"/").concat(n(t))}},84099:(e,t,a)=>{a.d(t,{y:()=>l});var r=a(32177),n=a(30921);function l(){let[e,t]=(0,r.Mj)("global-audio-volume",n.JZ);return{storedVolumeValue:e<0?0:e>100?100:e,setStoredVolumeValue:t}}},85292:(e,t,a)=>{a.d(t,{default:()=>h});var r=a(40828),n=a(61353),l=a(75451),i=a(8152),u=a(87139),o=a(23550);let s=e=>{if(0===e.length)return[];let t=e.filter(e=>!!e.file);return t.map((e,a)=>({previous:0===a?null:t[a-1],next:a===t.length-1?null:t[a+1],...e}))};var c=a(29122),d=a(45573),f=a(7705),p=a(35028),b=a(21110),y=a(30921),m=a(78545),g=a(78217),v=a(1061),k=a(84099);let h=e=>{let{children:t,userId:a,defaultPlaylist:h,defaultTrackId:S,isEmbedded:w}=e,[z,C]=u.useState(h||[]),{storedSessionUuid:T}=(0,b.y)(),x=a||T,{currentPlaybackCollection:I,mergeTracksIntoCurrentPlaybackCollection:P,setCurrentPlaybackCollection:E,soundRef:R,seekPendingRef:A,applyPendingVolumeChange:j,canStartPlaying:_,onCanStartPlaying:U,changePlaybackMute:L,resetProgressPositionWidth:H,stopPlayback:O,unloadAudioFile:B,clearSavedPlaybackCollectionId:M}=function(e,t){let a="ampwall.com",r=(0,c.usePathname)(),{_setCurrentPlaybackCollection:n,currentPlaybackCollection:l,setCanStartPlaying:i,canStartPlaying:f,soundRef:p,...b}=function(e){let t=(0,u.useRef)(!1),[a,r]=(0,u.useState)(e),[n,l]=(0,u.useState)(s(e)),i=(0,u.useRef)(null),c=(0,u.useRef)(null),d=(0,u.useRef)(null),f=(0,u.useRef)(null),p=(0,u.useRef)(null),b=(0,u.useRef)(null),y=(0,u.useRef)(null),m=(0,u.useRef)(null),g=(0,u.useRef)(!1),v=(0,u.useRef)(null),k=(0,u.useRef)(null),h=(0,u.useRef)(!1),S=(0,u.useRef)(null),w=(0,u.useRef)(null),z=(0,u.useCallback)(e=>{m.current&&(m.current.innerHTML=e)},[]),C=(0,u.useCallback)(e=>{let t=d.current;t&&(t.style.width=e)},[]),T=(0,u.useCallback)((e,t,a)=>{let r=f.current;r&&(r.style.left=(0,o.nR)(e,t,a))},[]),x=(0,u.useCallback)(()=>{let e=d.current;e&&(e.style.width="0%")},[]),I=(0,u.useCallback)((e,t,a)=>{let r=y.current;r&&(r.innerHTML=(0,o.rR)(a,e,t))},[]),P=(0,u.useCallback)(e=>{let t=i.current;t?(t.volume(e),S.current=null):S.current=e},[]),E=(0,u.useCallback)(()=>{S.current&&(P(S.current),S.current=null)},[P]),R=(0,u.useCallback)(()=>t.current,[t]),A=(0,u.useCallback)(e=>{t.current=e},[]),j=(0,u.useCallback)(e=>{let t=i.current;t&&(t.mute(e),e||t.volume(t.volume()))},[]),_=(0,u.useCallback)(()=>{i.current&&i.current.pause()},[]),U=(0,u.useCallback)(()=>{i.current&&i.current.stop()},[]),L=(0,u.useCallback)(()=>{var e;null==(e=i.current)||e.unload()},[]),H=(0,u.useCallback)(e=>{let t=v.current;t&&(t.style.width=(0,o.$U)(e));let a=k.current;a&&(a.style.left=(0,o.E9)(e))},[v,k]),O=(0,u.useCallback)(()=>{h.current=!0},[]),B=(0,u.useCallback)(()=>{h.current=!1},[h]),M=(0,u.useCallback)(e=>{let t=i.current;if(!h.current||!t)return;let a=p.current;if(!a)return;let r=a.getBoundingClientRect(),{minMaxPercent:n,percent:l}=(0,o.K1)({clientX:e,rectLeft:r.left,rectWidth:r.width});t.volume(n),H(l)},[h,H,i,p]),D=(0,u.useCallback)(()=>{g.current=!0},[]),F=(0,u.useCallback)(()=>{if("number"==typeof w.current){let e=i.current;e&&e.seek(w.current),w.current=null}g.current=!1},[g,w,i]),N=(0,u.useCallback)(()=>{let e=i.current;return!!(h.current||g.current)&&!!e},[h,g]),q=(0,u.useCallback)(e=>{let t=i.current;t&&null!==e&&(w.current=null,t.seek(e))},[]);(0,u.useEffect)(()=>()=>{L()},[L]);let J=(0,u.useCallback)(e=>{switch(e){case"mouseLeave":B(),g.current&&F();break;case"mouseUp":t.current=!0,B(),g.current&&F();break;case"touchEnd":t.current=!0,B(),F()}},[F,B]);return{playlist:a,setPlaylist:r,currentPlaybackCollection:n,soundRef:i,progressTrackRef:c,progressRef:d,volumeRef:p,barEmptyRef:b,timerRef:y,trackRef:m,progressSliderButtonRef:f,changingSeekRef:g,barFullRef:v,volumeSliderButtonRef:k,changingVolumeRef:h,seekPendingRef:w,applyPendingVolumeChange:E,handleVolumeSliderPositionUpdate:H,changePlaybackMute:j,onChangeVolumeSpecific:P,onMouseOrTouchEventEnd:J,onMoveVolumeSlider:M,onStartMoveSeekSlider:D,onStartMoveVolumeSlider:O,canStartPlaying:R,setCanStartPlaying:A,setProgressSliderWidth:T,resetProgressPositionWidth:x,setSeekUiPercentage:C,setSeekValue:q,setTimerValue:I,pausePlayback:_,shouldTrackCursorMovement:N,stopPlayback:U,updateTrackName:z,unloadAudioFile:L,_setCurrentPlaybackCollection:l}}(e),{clearSavedPlaybackCollectionId:y,onPersistCurrentPlaybackCollectionId:m}=(0,d.Q)(t),g=(0,u.useCallback)(function(e,t){let l=!(arguments.length>2)||void 0===arguments[2]||arguments[2];t&&l&&m(t,a,r),n(s(e))},[n,m,a,r]),v=(0,u.useCallback)((e,t)=>{if(e.length>0){let t=s(e),a=t[t.length-1],r=l[0];a.next=r,r.previous=a,l.unshift(...t)}if(t.length>0){let e=s(t),a=l[l.length-1],r=e[0];a.next=r,r.previous=a,l.push(...e)}l.length!=l.length&&n(l)},[n,l]),k=(0,u.useCallback)(()=>{i(!1)},[i]),h=(0,u.useCallback)(()=>{i(!0)},[i]);return(0,u.useEffect)(()=>{let e=()=>{var e;!document.hidden||(null==(e=p.current)?void 0:e.playing())||k()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[k,p]),{...b,soundRef:p,canStartPlaying:f,setCanStartPlaying:i,onCanStartPlaying:h,onCannotStartPlaying:k,currentPlaybackCollection:l,clearSavedPlaybackCollectionId:y,setCurrentPlaybackCollection:g,mergeTracksIntoCurrentPlaybackCollection:v}}(z,a),D=(0,u.useRef)(y.JZ/100),[F,N]=u.useState(I.find(e=>e.featuredTrack)||I[0]),q=u.useRef(F);q.current=F;let[J,X]=u.useState("paused"),[Z,Q]=u.useState((0,n.FI)((null==F?void 0:F.duration)||null)),[V,K]=u.useState(!1),[W,G]=u.useState(0),[Y,$]=u.useState({id:"",type:"album"});(0,u.useEffect)(()=>{if(!(h&&h.length>0))return;let e=s(h);if(E(e,Y),S){let t=e.find(e=>e.id===S);t&&N(t)}else N(e[0])},[h,S]);let ee=(0,u.useCallback)(e=>{K(t=>{let a=void 0===e?!t:e;return L(a),a})},[L]),{sendPlaybackEventRef:et}=function(e){let{activeTrack:t,collection:a,userId:r,isEmbedded:n}=e,[l,i]=(0,u.useTransition)(),[o,s]=(0,u.useState)(""),[c,f]=(0,u.useState)(""),{storedPlaybackCollectionData:p}=(0,d.Q)(r),{storedSessionUuid:y}=(0,b.y)(),m=r||y;(0,u.useEffect)(()=>{if(!n)return;let e=document.referrer;try{let t=new URL(e);s(t.hostname),f(t.pathname)}catch(e){}},[n]);let g=(0,u.useCallback)(e=>{let{completed:r=!1,currentSeekVal:l=0}=e;if(!t||!t.duration||t.listenerTrackingData.isListenerDistroOwner)return;let u=Math.round(t.duration),s={distroId:t.album.distroId,sourceId:a.id,listenerId:m,trackId:t.id,createdAt:new Date().toISOString(),eventPosition:r?u:Math.round(l),trackDuration:u,platform:"website",sourceType:a.type,playbackHostname:n?o:null==p?void 0:p.playbackHostname,playbackUrlPath:n?c:null==p?void 0:p.playbackUrlPath,listenerType:t.listenerTrackingData.listenerType},d=.1>Math.floor(l/u),f=l<5&&d;i(async()=>{r?await (0,v.O0)(s):f?await (0,v.dQ)(s):await (0,v.H2)(s)})},[t,m,a,n,o,p,c]),k=u.useRef(g);return k.current=g,{sendPlaybackEventRef:k,sendPlaybackEvent:g}}({activeTrack:F,userId:x,isEmbedded:w,collection:Y}),ea=(0,u.useCallback)(e=>{var t,a,r,u;let{id:o,startPlayingImmediately:s=!0,isAllowedToResetToZero:c=!0}=e,d=I.find(e=>e.id===o);if(!(null==d?void 0:d.file)){if(null==F||null==(a=F.next)?void 0:a.id){if(F.next.id===o){let e=Error("Trying to play the same track twice");l.Cp(e,{extra:{id:o,nextId:F.next.id,startPlayingImmediately:s,isAllowedToResetToZero:c}});return}return ea({id:F.next.id,startPlayingImmediately:s,isAllowedToResetToZero:c})}if(c){X("paused");let e=null==(r=I.at(0))?void 0:r.id;if(!e)return;return ea({id:e,startPlayingImmediately:!1,isAllowedToResetToZero:!1})}return}if(H(),O(),B(),A.current=null,R.current=new i.Howl({src:[d.file],html5:!0,volume:(null==(t=R.current)?void 0:t.volume())||(null!=(u=D.current)?u:.5),onplay:()=>{if(!R.current)return;R.current.duration()&&Q((0,n.FI)(Math.round(R.current.duration())));let e=A.current;null!==e&&(A.current=null,R.current.seek(e)),X("playing")},onload:()=>{var e;(null==(e=R.current)?void 0:e.duration())&&Q((0,n.FI)(Math.round(R.current.duration())))},onend:()=>{var e,t;et.current({completed:!0}),B();let a=null==(t=q.current)||null==(e=t.next)?void 0:e.id;if(!a)return void X("paused");ea({id:a,startPlayingImmediately:!0,isAllowedToResetToZero:!0})},onpause:()=>{X("paused")},onstop:()=>{},onseek:()=>{if(!R.current)return}}),d.howl=R.current,V&&ee(!0),N(d),s){if(!_())return void X("paused");R.current.play(),j()}},[I,H,O,B,A,R,V,_,j,F,et,ee]),er=(0,u.useCallback)(()=>{var e;let t=(null==F?void 0:F.id)||(null==(e=I.find(e=>e.file))?void 0:e.id);t&&ea({id:t,startPlayingImmediately:!0,isAllowedToResetToZero:!0})},[null==F?void 0:F.id,I,ea]),en=u.useCallback(()=>{var e;if(!R.current)return void er();(null==(e=R.current)?void 0:e.playing())||R.current.play()},[er,R]),el=(0,u.useCallback)(e=>{G(0),ea({id:e,startPlayingImmediately:!0,isAllowedToResetToZero:!0})},[ea]),ei=u.useCallback(()=>{R.current&&R.current.pause(),X("paused")},[R]),eu=u.useRef(null),eo=(0,u.useCallback)(()=>{var e;let t=null==(e=R.current)?void 0:e.seek();void 0!==t&&et.current({completed:!1,currentSeekVal:t})},[R,et]),{isLoadingAllTracks:es,allTracks:ec,setFetchAllTracks:ed}=function(e){let[t,a]=u.useState(!1),{data:r,isLoading:n}=(0,p.x)(["collection-all-tracks",e.id],t,e);return{isLoadingAllTracks:n,allTracks:r,fetchAllTracks:t,setFetchAllTracks:a}}(Y),{collectionToLazyLoad:ef,lazilyLoadedCollection:ep,setCollectionToLazyLoad:eb}=function(){let[e,t]=u.useState(null),{data:a,isLoading:r}=(0,p.x)(["lazy-load-collection",(null==e?void 0:e.collection.id)||null],!0,(null==e?void 0:e.collection)||null);return{collectionToLazyLoad:e,setCollectionToLazyLoad:t,lazilyLoadedCollection:a,isLoadingLazilyLoadedCollection:r}}();u.useEffect(()=>{if(!es&&ec&&ec.length>0){ed(!1);let{uniqueTracksBefore:e,uniqueTracksAfter:t}=function(e,t,a){let r=new Set(t.map(e=>e.id)),n=a?e.findIndex(e=>e.id===(null==a?void 0:a.id)):-1,{uniqueTracksBefore:l,uniqueTracksAfter:i}=e.reduce((e,t,a)=>(r.has(t.id)||(a<n?e.uniqueTracksBefore.push(t):a>n&&e.uniqueTracksAfter.push(t)),e),{uniqueTracksBefore:[],uniqueTracksAfter:[]});return{uniqueTracksBefore:l,uniqueTracksAfter:i}}(ec,I,F);(e.length>0||t.length>0)&&P(e,t)}},[ec,es]);let ey=u.useCallback(e=>{switch(e.action){case"seek":{if(U(),!R.current)return;let t=(0,o.kO)(R.current,e.newSeekPercent);R.current.seek(t),R.current.playing()||G(t);break}case"seekExact":if(!R.current)break;U(),R.current.seek(e.position);break;case"pause":U(),ei();break;case"resume":U(),en();break;case"skipTo":e.canStartPlaying&&U(),eo(),el(e.trackId);break;case"toggleMute":U(),ee();break;case"volume":break;case"replaceQueueAndPlay":{let{payload:t,newActiveTrackId:a,canStartPlaying:r,collection:n,fetchAllTracks:l,persist:i}=e;r&&U();let u=s(t);$(n),E(u,n,i),eu.current=a,ed(l);break}case"fetchCollectionAndReplaceAndPlay":{let{collection:t,targetTrackId:a}=e;$(t),eb({collection:t,targetTrackId:a});break}case"closeAudioPlayer":X("paused"),E([],{id:"",type:"album"}),N(void 0),O(),B(),M()}},[U,R,ei,en,eo,el,ee,E,ed,eb,O,B,M]);u.useEffect(()=>{if(!ef||!(null==ep?void 0:ep.length))return;let e=ef.targetTrackId?ep.find(e=>e.id===ef.targetTrackId)||ep.find(e=>e.file):ep.find(e=>e.file);e&&ey({action:"replaceQueueAndPlay",canStartPlaying:!0,payload:ep,newActiveTrackId:ef.targetTrackId||(null==e?void 0:e.id)||"",collection:ef.collection,fetchAllTracks:!0,persist:!0})},[ep]),u.useEffect(()=>{if(!eu.current)return;let e=eu.current;eu.current=null,ey({action:"skipTo",trackId:e,canStartPlaying:!1})},[I]),u.useEffect(()=>{let e=I.at(0);e&&ea({id:e.id,startPlayingImmediately:!1,isAllowedToResetToZero:!0})},[]);let em=(0,u.useCallback)(()=>{ey({action:"resume"})},[ey]),eg=(0,u.useCallback)(()=>{ey({action:"pause"})},[ey]),ev=(0,u.useCallback)(e=>{ey({action:"seekExact",position:e})},[ey]);!function(e){let{media:t,onPlayRequest:a,onPauseRequest:r,onSeekRequest:n,playbackState:l}=e,[i,o]=(0,u.useState)(!1);(0,u.useEffect)(()=>o("mediaSession"in navigator),[]),(0,u.useEffect)(()=>{if(!i||!t)return;let e=t.imagePath?[{src:(0,m.cloudflareImageOrOriginal)({src:(0,g.rl)(t.imagePath),width:512}),sizes:"512x512",type:"image/jpg"}]:void 0;return navigator.mediaSession.metadata=new MediaMetadata({title:t.title,artist:t.artist,album:t.album,artwork:e}),t.duration&&navigator.mediaSession.setPositionState({duration:t.duration,playbackRate:1,position:0}),()=>{navigator.mediaSession.metadata=null}},[i,t]),(0,u.useEffect)(()=>{if(i&&t)return navigator.mediaSession.setActionHandler("play",a),()=>{navigator.mediaSession.setActionHandler("play",null)}},[i,t,a]),(0,u.useEffect)(()=>{if(i&&t)return navigator.mediaSession.setActionHandler("pause",r),()=>{navigator.mediaSession.setActionHandler("pause",null)}},[i,t,r]),(0,u.useEffect)(()=>{if(i&&t)return navigator.mediaSession.setActionHandler("seekto",e=>{e.seekTime&&n&&n(e.seekTime)}),()=>{navigator.mediaSession.setActionHandler("seekto",null)}},[i,t,n]),(0,u.useEffect)(()=>{if(i&&t)return navigator.mediaSession.setActionHandler("stop",r),()=>{navigator.mediaSession.setActionHandler("stop",null)}},[i,t,r]),(0,u.useEffect)(()=>{i&&t&&(navigator.mediaSession.playbackState=l)},[i,t,l])}({media:u.useMemo(()=>F?{title:F.title,artist:F.artists.map(e=>e.name).join(", "),album:F.album.name,imagePath:F.imagePath,duration:F.duration}:void 0,[F]),onPlayRequest:em,onPauseRequest:eg,onSeekRequest:ev,playbackState:J});let{storedVolumeValue:ek}=(0,k.y)();return u.useEffect(()=>{D.current=ek/100},[ek]),(0,r.jsx)(f.K.Provider,{value:{onCanStartPlaying:U,playbackState:J,setPlaybackState:X,isMuted:V,setIsMuted:K,currentPlaybackCollection:I,setCurrentPlaybackCollection:E,activeTrack:F,onPlayerEvent:ey,setInitialPlaylistWithMixedPlayableUnplayableTracks:C,soundRef:R,seekValue:W,duration:Z,globalVolumeRef:D,collection:Y},children:t})}},85526:(e,t,a)=>{a.d(t,{An:()=>c,PS:()=>d,Yg:()=>l,_j:()=>u,cG:()=>i,g$:()=>o,pz:()=>s});var r=a(11354),n=a.n(r);function l(e,t){return n()(e,{fromCents:!1,symbol:d(t)})}function i(e,t){return n()(e,{symbol:d(t)})}function u(e,t){return n()(e,{fromCents:!0,symbol:d(t)})}function o(e,t){return u(e,t).format()}function s(e,t,a){return n()(e,{fromCents:!0,symbol:d(a)}).divide(t).format()}function c(e,t){return u(e,t).toString()}function d(e){return 0..toLocaleString("en-US",{style:"currency",currency:e.toUpperCase(),minimumFractionDigits:0,maximumFractionDigits:0}).replace(/\d/g,"").trim()}}}]);